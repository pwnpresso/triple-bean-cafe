<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Triple Bean Cafe Â· Menu</title>
  <meta name="description" content="House beverage menu for Triple Bean Cafe." />
  <meta name="theme-color" content="#5b4636" />
  <link rel="icon" href="images/favicon.svg">
  <link rel="preload" href="images/logo.svg" as="image" type="image/svg+xml">
  <link rel="stylesheet" href="styles.css">
</head>
<body>
  <div class="container">
    <header>
      <div class="brand">
        <img class="logo" src="images/logo.svg" alt="Triple Bean Cafe logo">
        <h1>Triple Bean Cafe</h1>
      </div>
      <p class="tagline">
        â˜•ðŸŒ¿ Welcome to Triple Bean CafÃ© â€” a cosy corner for coffee, calm, and conversation.<br><br>
        We brew with care, take pride in slow mornings, and believe good coffee should feel like a small luxury.<br><br>
        âœ¨ Sit. Stay. Sip.<br>
        Your seat is always waiting.
      </p>
    </header>

    <main class="menu" aria-label="Menu">
      <div class="menu-header">
        <h2>Beverages</h2>
        <p class="note">Ice available upon request â€¢ No decaf</p>
      </div>
      <div class="divider" role="separator" aria-hidden="true"></div>

      <div class="sections" id="menuSections">
        <!-- Coffee -->
        <section class="section" aria-labelledby="coffee-title">
          <h3 id="coffee-title">Coffee</h3>
          <ul class="menu-list">
            <li class="card orderable" data-item="Iced Black">
              <div class="icon" data-badge="â„ï¸"><img src="images/iced-black.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Iced Black</div><div class="meta">Tap to add</div></div>
              <div class="qty" data-qty="Iced Black"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
            <li class="card orderable" data-item="Hot Black">
              <div class="icon" data-badge="ðŸ”¥"><img src="images/hot-black.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Hot Black</div><div class="meta">Tap to add</div></div>
              <div class="qty" data-qty="Hot Black"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
            <li class="card orderable" data-item="Iced White">
              <div class="icon" data-badge="â„ï¸"><img src="images/iced-white.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Iced White</div><div class="meta">Tap to add</div></div>
              <div class="qty" data-qty="Iced White"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
            <li class="card orderable" data-item="Hot White">
              <div class="icon" data-badge="ðŸ”¥"><img src="images/hot-white.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Hot White</div><div class="meta">Tap to add</div></div>
              <div class="qty" data-qty="Hot White"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
            <li class="card orderable" data-item="Aerocano">
              <div class="icon" data-badge="â„ï¸"><img src="images/aerocano.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Aerocano</div><div class="meta">Aerated espresso on ice â€¢ Tap to add</div></div>
              <div class="qty" data-qty="Aerocano"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
            <li class="card orderable" data-item="Affogato">
              <div class="icon" data-badge="â„ï¸"><img src="images/affogato.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Affogato</div><div class="meta">Vanilla ice cream + double espresso â€¢ Tap to add</div></div>
              <div class="qty" data-qty="Affogato"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
          </ul>
        </section>

        <!-- Tea -->
        <section class="section" aria-labelledby="tea-title">
          <h3 id="tea-title">Tea</h3>
          <ul class="menu-list">
            <li class="card orderable" data-item="Iced Matcha Latte">
              <div class="icon" data-badge="â„ï¸"><img src="images/iced-matcha.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Iced Matcha Latte</div><div class="meta">Tap to add</div></div>
              <div class="qty" data-qty="Iced Matcha Latte"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
            <li class="card orderable" data-item="Hot Matcha Latte">
              <div class="icon" data-badge="ðŸ”¥"><img src="images/hot-matcha.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Hot Matcha Latte</div><div class="meta">Tap to add</div></div>
              <div class="qty" data-qty="Hot Matcha Latte"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
            <li class="card orderable" data-item="Iced Strawberry Matcha Latte">
              <div class="icon" data-badge="â„ï¸"><img src="images/strawberry-matcha.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Matcha Ichigo</div><div class="meta">Strawberry puree + matcha + milk â€¢ Tap to add</div></div>
              <div class="qty" data-qty="Iced Strawberry Matcha Latte"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
          </ul>
        </section>

        <!-- Misc -->
        <section class="section" aria-labelledby="misc-title">
          <h3 id="misc-title">Misc</h3>
          <ul class="menu-list">
            <li class="card">
              <div class="icon"><img src="images/fridge.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Assorted Drinks in Fridge</div><div class="meta">Self-serve â€” help yourself from the fridge</div></div>
            </li>
            <li class="card orderable" data-item="Gin & Tonic">
              <div class="icon" data-badge="â„ï¸"><img src="images/gin-tonic.svg" alt="" width="32" height="32"></div>
              <div><div class="name">Gin &amp; Tonic</div><div class="meta">Tap to add</div></div>
              <div class="qty" data-qty="Gin & Tonic"><button type="button" data-action="dec">âˆ’</button><span class="count">0</span><button type="button" data-action="inc">+</button></div>
            </li>
          </ul>
        </section>
      </div>

      <div class="divider" role="separator" aria-hidden="true"></div>

      <div class="footer-bar">
        <div class="order-inputs">
          <input id="guestName" class="input" placeholder="Your name (optional)" autocomplete="name">
          <input id="note" class="input" placeholder="Note (optional): e.g., less ice / oat milk">
        </div>
        <div class="order-actions">
          <button id="sendBtn" class="button primary" type="button">Send Order</button>
          <div id="closedMsg" class="closed" style="display:none;" role="alert">Ordering is currently closed.</div>
        </div>
      </div>
      <div id="status" class="status" role="status" aria-live="polite"></div>

      <footer>Â© <span id="year"></span> Triple Bean Cafe Â· Handmade at home</footer>
    </main>
  </div>

  <script>
    document.getElementById('year').textContent = new Date().getFullYear();

    // >>> REPLACE with your current /exec URL (keep it exactly as in your working version)
    const ORDER_ENDPOINT = "https://script.google.com/macros/s/AKfycbykR7MxOkPuKtz7Sa92HJG9W1qOecMrydAf7LPQBYL2wpA1ULcj97WAfcBWZW29CdmJ/exec";

    const counts = {};
    const cards = document.querySelectorAll('.card.orderable');
    cards.forEach(card => {
      const item = card.getAttribute('data-item');
      counts[item] = 0;
      card.addEventListener('click', (e)=>{ if(!e.target.closest('button')) inc(item); });
      const qty = card.querySelector('.qty');
      qty.querySelector('[data-action="inc"]').addEventListener('click', (e)=>{ e.stopPropagation(); inc(item); });
      qty.querySelector('[data-action="dec"]').addEventListener('click', (e)=>{ e.stopPropagation(); dec(item); });
    });
    function render(item){ const el=document.querySelector('.qty[data-qty="'+item.replace(/"/g,'&quot;')+'"] .count'); if(el) el.textContent=counts[item]; }
    function inc(item){ counts[item]=Math.min(99,(counts[item]||0)+1); render(item); }
    function dec(item){ counts[item]=Math.max(0,(counts[item]||0)-1); render(item); }

    const statusEl = document.getElementById('status');
    const sendBtn = document.getElementById('sendBtn');
    const closedMsg = document.getElementById('closedMsg');

    async function checkOpen(){
      try{
        const res = await fetch(ORDER_ENDPOINT, { method:'GET', headers:{ 'Accept':'application/json' }});
        const data = await res.json();
        const open = !!(data && data.open);
        sendBtn.disabled = !open;
        closedMsg.style.display = open ? 'none' : '';
      }catch{ /* ignore */ }
    }
    checkOpen();

    sendBtn.addEventListener('click', async ()=>{
      const items = Object.entries(counts).filter(([k,v])=>v>0).map(([name,qty])=>({name,qty}));
      if(items.length===0){ statusEl.textContent="Add at least one item by tapping."; return; }
      const payload = { from:(document.getElementById('guestName').value||'').trim(), note:(document.getElementById('note').value||'').trim(), items };
      statusEl.textContent = "Sendingâ€¦";
      try{
        const res = await fetch(ORDER_ENDPOINT, { method:'POST', headers:{ 'Content-Type':'text/plain;charset=utf-8' }, body: JSON.stringify(payload) });
        const data = await res.json().catch(()=>({}));
        if(data.ok){
          statusEl.textContent = "Order sent! Thank you â˜•.";
          Object.keys(counts).forEach(k=>{ counts[k]=0; render(k); });
          document.getElementById('guestName').value=""; document.getElementById('note').value="";
        } else if(data.error==="closed"){
          statusEl.textContent = "Ordering is closed.";
          sendBtn.disabled = true; closedMsg.style.display='';
        } else {
          statusEl.textContent = "Failed to send.";
        }
      }catch{ statusEl.textContent = "Network error."; }
    });
  </script>
</body>
</html>